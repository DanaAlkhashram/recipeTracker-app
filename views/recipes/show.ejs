<%- include('../partials/head') %>

  <div class="container mt-4" style="max-width: 700px;">
    <h2 class="text-center mb-3">
      <%= foundrecipe.title %>
    </h2>

    <img src="<%= foundrecipe.image %>" class="img-fluid rounded mb-3" alt="Image of <%= foundrecipe.title %>">

    <p><strong>Ingredients:</strong>
      <%= foundrecipe.ingredients %>
    </p>
    <p><strong>Steps:</strong>
      <%= foundrecipe.steps %>
    </p>
    <p><strong>Chef:</strong>
      <%= foundrecipe.chef.username %>
    </p>

    <a href="/recipes" class="btn btn-secondary mt-3">Back to Recipes</a>
    <% if (foundrecipe.chef._id.equals(user._id)) { %>
      <form action="/recipes/<%= foundrecipe._id %>?_method=DELETE" method="POST">
        <button type="submit" class="btn btn-danger">Delete</button>
      </form>
      <a href="/recipes/<%= foundrecipe._id %>/edit" class="btn btn-warning">Edit</a>
      <% } %>

        <h3 class="text-center">Leave a Comment</h3>
        <form action="/recipes/<%= foundrecipe._id %>/comments" method="POST" class="mb-4">
          <div class="mb-3">
            <textarea name="content" class="form-control" rows="2" required></textarea>
          </div>
          <button type="submit" class="btn btn-primary">Post Comment</button>
        </form>
           <h3 class="text-center">Comments</h3>
<ul class="list-group">
  <% foundrecipe.comments.forEach((comment) => { %>
    <li class="list-group-item">
      <%= comment.content %> â€” <em><%= comment.author.username %></em>

      <% if (comment.author._id.equals(user._id)) { %>
        <!-- Edit Form -->
        <form action="/recipes/<%= foundrecipe._id %>/comments/<%= comment._id %>?_method=PUT" method="POST" class="mt-2">
          <input type="text" name="content" value="<%= comment.content %>" class="form-control mb-2" required />
          <button class="btn btn-warning btn-sm" type="submit">Update</button>
        </form>

        <!-- Delete Form -->
        <form action="/recipes/<%= foundrecipe._id %>/comments/<%= comment._id %>?_method=DELETE" method="POST" class="mt-2">
          <button class="btn btn-danger btn-sm">Delete</button>
        </form>
      <% }}) %>
    </li>
  </div>

  </body>

  </html>